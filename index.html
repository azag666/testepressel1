
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carregando...</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #1a1a1a; /* Fundo escuro */
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        .loader-container {
            text-align: center;
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-left-color: #ffffff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        p {
            font-size: 1.2em;
            opacity: 0;
            animation: fadeIn 1s forwards;
            animation-delay: 0.5s;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1&ev=PageView&noscript=1"
    /></noscript>
    <script>
        (async function() {
            const CONFIG = {
                                PRESSEL_ID: 29,
                WHITE_PAGE_URL: "https://br.pinterest.com/pin/22095854406665522/",
                BOT_USERNAME: "joycejaccobot",
                API_BASE_URL: "https://hottrack-staging.up.railway.app"
            };
            function getQueryParam(param) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(param);
            }
            function getFacebookCookies() {
                const cookies = document.cookie.split('; ');
                let fbp = null, fbc = null;
                for (const cookie of cookies) {
                    const parts = cookie.split('=');
                    if (parts[0] === '_fbp') fbp = parts[1];
                    if (parts[0] === '_fbc') fbc = parts[1];
                }
                return { fbp, fbc };
            }
            try {
                // Bloqueia bots conhecidos do Facebook para evitar poluir as métricas
                const userAgent = navigator.userAgent;
                if (/facebookexternalhit|Facebot/i.test(userAgent)) {
                    console.log('Bot do Facebook detectado. Redirecionando...');
                    window.location.href = CONFIG.WHITE_PAGE_URL;
                    return; // Interrompe a execução
                }

                
            // Verificar se é mobile
            const isMobile = /android|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent);
            if (!isMobile) {
                window.location.href = CONFIG.WHITE_PAGE_URL;
                return;
            }
                const { fbp, fbc } = getFacebookCookies();
                const response = await fetch(CONFIG.API_BASE_URL + '/api/registerClick', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                                                presselId: CONFIG.PRESSEL_ID,
                        referer: document.referrer || null,
                        fbclid: getQueryParam('fbclid'),
                        fbp: fbp,
                        fbc: fbc,
                        user_agent: navigator.userAgent,
                        utm_source: getQueryParam('utm_source'),
                        utm_campaign: getQueryParam('utm_campaign'),
                        utm_medium: getQueryParam('utm_medium'),
                        utm_content: getQueryParam('utm_content'),
                        utm_term: getQueryParam('utm_term')
                    })
                });
                if (!response.ok) throw new Error('Falha ao registrar clique.');
                const { click_id } = await response.json();

                // Dispara ViewContent no Pixel da Meta
                fbq('track', 'ViewContent', {}, { eventID: click_id });

                const botUrl = `https://t.me/${CONFIG.BOT_USERNAME}?start=${click_id}`;
                window.location.href = botUrl;
            } catch (error) {
                console.error("Erro na pressel:", error);
                window.location.href = CONFIG.WHITE_PAGE_URL; // Redireciona para página branca em caso de erro
            }
        })();
    </script>
</head>
<body>
    <div class="loader-container">
        <div class="spinner"></div>
        <p>Aguarde, estamos redirecionando...</p>
    </div>
</body>
</html>
